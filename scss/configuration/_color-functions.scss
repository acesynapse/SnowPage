$primary-color: #bea7ff !default;
$white: white;
$black: black;
$off-white: darken(white, 3%);
$off-black: lighten(black, 3%);
$grey: grey;

// Map of luminescence without using exponents
$lum-map: (255:1,254:0.991102,253:0.982251,252:0.973445,251:0.964686,250:0.955973,249:0.947307,248:0.938686,247:0.930111,246:0.921582,245:0.913099,244:0.904661,243:0.896269,242:0.887923,241:0.879622,240:0.871367,239:0.863157,238:0.854993,237:0.846873,236:0.838799,235:0.83077,234:0.822786,233:0.814847,232:0.806952,231:0.799103,230:0.791298,229:0.783538,228:0.775822,227:0.768151,226:0.760525,225:0.752942,224:0.745404,223:0.73791,222:0.730461,221:0.723055,220:0.715694,219:0.708376,218:0.701102,217:0.693872,216:0.686685,215:0.679542,214:0.672443,213:0.665387,212:0.658375,211:0.651406,210:0.64448,209:0.637597,208:0.630757,207:0.62396,206:0.617207,205:0.610496,204:0.603827,203:0.597202,202:0.590619,201:0.584078,200:0.57758,199:0.571125,198:0.564712,197:0.55834,196:0.552011,195:0.545724,194:0.539479,193:0.533276,192:0.527115,191:0.520996,190:0.514918,189:0.508881,188:0.502886,187:0.496933,186:0.491021,185:0.48515,184:0.47932,183:0.473531,182:0.467784,181:0.462077,180:0.456411,179:0.450786,178:0.445201,177:0.439657,176:0.434154,175:0.42869,174:0.423268,173:0.417885,172:0.412543,171:0.40724,170:0.401978,169:0.396755,168:0.391572,167:0.386429,166:0.381326,165:0.376262,164:0.371238,163:0.366253,162:0.361307,161:0.3564,160:0.351533,159:0.346704,158:0.341914,157:0.337164,156:0.332452,155:0.327778,154:0.323143,153:0.318547,152:0.313989,151:0.309469,150:0.304987,149:0.300544,148:0.296138,147:0.291771,146:0.287441,145:0.283149,144:0.278894,143:0.274677,142:0.270498,141:0.266356,140:0.262251,139:0.258183,138:0.254152,137:0.250158,136:0.246201,135:0.242281,134:0.238398,133:0.234551,132:0.23074,131:0.226966,130:0.223228,129:0.219526,128:0.215861,127:0.212231,126:0.208637,125:0.205079,124:0.201556,123:0.198069,122:0.194618,121:0.191202,120:0.187821,119:0.184475,118:0.181164,117:0.177888,116:0.174647,115:0.171441,114:0.168269,113:0.165132,112:0.162029,111:0.158961,110:0.155926,109:0.152926,108:0.14996,107:0.147027,106:0.144128,105:0.141263,104:0.138432,103:0.135633,102:0.132868,101:0.130136,100:0.127438,99:0.124772,98:0.122139,97:0.119538,96:0.116971,95:0.114435,94:0.111932,93:0.109462,92:0.107023,91:0.104616,90:0.102242,89:0.099899,88:0.097587,87:0.095307,86:0.093059,85:0.090842,84:0.088656,83:0.0865,82:0.084376,81:0.082283,80:0.08022,79:0.078187,78:0.076185,77:0.074214,76:0.072272,75:0.07036,74:0.068478,73:0.066626,72:0.064803,71:0.06301,70:0.061246,69:0.059511,68:0.057805,67:0.056128,66:0.05448,65:0.052861,64:0.051269,63:0.049707,62:0.048172,61:0.046665,60:0.045186,59:0.043735,58:0.042311,57:0.040915,56:0.039546,55:0.038204,54:0.036889,53:0.035601,52:0.03434,51:0.033105,50:0.031896,49:0.030713,48:0.029557,47:0.028426,46:0.027321,45:0.026241,44:0.025187,43:0.024158,42:0.023153,41:0.022174,40:0.021219,39:0.020289,38:0.019382,37:0.0185,36:0.017642,35:0.016807,34:0.015996,33:0.015209,32:0.014444,31:0.013702,30:0.012983,29:0.012286,28:0.011612,27:0.01096,26:0.01033,25:0.009721,24:0.009134,23:0.008568,22:0.008023,21:0.007499,20:0.006995,19:0.006512,18:0.006049,17:0.005605,16:0.005182,15:0.004777,14:0.004391,13:0.004025,12:0.003677,11:0.003347,10:0.003035,9:0.002732,8:0.002428,7:0.002125,6:0.001821,5:0.001518,4:0.001214,3:0.000911,2:0.000607,1:0.000304,0:0);

// Map of reflection without using exponents
$ref-map: (255:0.3333,254:0.3299,253:0.3266,252:0.3233,251:0.32,250:0.3167,249:0.3135,248:0.3102,247:0.307,246:0.3038,245:0.3007,244:0.2975,243:0.2944,242:0.2913,241:0.2882,240:0.2852,239:0.2821,238:0.2791,237:0.2761,236:0.2731,235:0.2701,234:0.2672,233:0.2643,232:0.2614,231:0.2585,230:0.2557,229:0.2528,228:0.25,227:0.2472,226:0.2444,225:0.2417,224:0.2389,223:0.2362,222:0.2335,221:0.2308,220:0.2282,219:0.2255,218:0.2229,217:0.2203,216:0.2177,215:0.2152,214:0.2126,213:0.2101,212:0.2076,211:0.2051,210:0.2026,209:0.2002,208:0.1977,207:0.1953,206:0.1929,205:0.1906,204:0.1882,203:0.1859,202:0.1835,201:0.1812,200:0.179,199:0.1767,198:0.1744,197:0.1722,196:0.17,195:0.1678,194:0.1656,193:0.1635,192:0.1614,191:0.1592,190:0.1571,189:0.155,188:0.153,187:0.1509,186:0.1489,185:0.1469,184:0.1449,183:0.1429,182:0.1409,181:0.139,180:0.1371,179:0.1351,178:0.1332,177:0.1314,176:0.1295,175:0.1277,174:0.1258,173:0.124,172:0.1222,171:0.1205,170:0.1187,169:0.1169,168:0.1152,167:0.1135,166:0.1118,165:0.1101,164:0.1085,163:0.1068,162:0.1052,161:0.1036,160:0.102,159:0.1004,158:0.0988,157:0.0972,156:0.0957,155:0.0942,154:0.0927,153:0.0912,152:0.0897,151:0.0882,150:0.0868,149:0.0854,148:0.084,147:0.0825,146:0.0812,145:0.0798,144:0.0784,143:0.0771,142:0.0758,141:0.0744,140:0.0731,139:0.0719,138:0.0706,137:0.0693,136:0.0681,135:0.0669,134:0.0657,133:0.0645,132:0.0633,131:0.0621,130:0.0609,129:0.0598,128:0.0587,127:0.0575,126:0.0564,125:0.0554,124:0.0543,123:0.0532,122:0.0522,121:0.0511,120:0.0501,119:0.0491,118:0.0481,117:0.0471,116:0.0461,115:0.0452,114:0.0442,113:0.0433,112:0.0424,111:0.0415,110:0.0406,109:0.0397,108:0.0388,107:0.038,106:0.0371,105:0.0363,104:0.0354,103:0.0346,102:0.0338,101:0.0331,100:0.0323,99:0.0315,98:0.0308,97:0.03,96:0.0293,95:0.0286,94:0.0279,93:0.0272,92:0.0265,91:0.0258,90:0.0251,89:0.0245,88:0.0238,87:0.0232,86:0.0226,85:0.022,84:0.0214,83:0.0208,82:0.0202,81:0.0196,80:0.0191,79:0.0185,78:0.018,77:0.0175,76:0.017,75:0.0164,74:0.0159,73:0.0155,72:0.015,71:0.0145,70:0.014,69:0.0136,68:0.0132,67:0.0127,66:0.0123,65:0.0119,64:0.0115,63:0.0111,62:0.0107,61:0.0103,60:0.0099,59:0.0096,58:0.0092,57:0.0089,56:0.0085,55:0.0082,54:0.0079,53:0.0076,52:0.0073,51:0.007,50:0.005,49:0.0049,48:0.0048,47:0.0047,46:0.0046,45:0.0045,44:0.0044,43:0.0043,42:0.0042,41:0.0041,40:0.004,39:0.0039,38:0.0038,37:0.0037,36:0.0036,35:0.0035,34:0.0034,33:0.0033,32:0.0032,31:0.0031,30:0.003,29:0.0029,28:0.0028,27:0.0027,26:0.0026,25:0.0025,24:0.0024,23:0.0023,22:0.0022,21:0.0021,20:0.002,19:0.0019,18:0.0018,17:0.0017,16:0.0016,15:0.0015,14:0.0014,13:0.0013,12:0.0012,11:0.0011,10:0.001,9:0.0009,8:0.0008,7:0.0007,6:0.0006,5:0.0005,4:0.0004,3:0.0003,2:0.0002,1:0.0001,0:0);

// Map of gamma values without using exponents
$gamma-map: (255:1,254:0.991393,253:0.982826,252:0.9743,251:0.965815,250:0.95737,249:0.948965,248:0.940601,247:0.932277,246:0.923993,245:0.91575,244:0.907547,243:0.899385,242:0.891262,241:0.88318,240:0.875138,239:0.867136,238:0.859174,237:0.851252,236:0.84337,235:0.835528,234:0.827726,233:0.819964,232:0.812241,231:0.804559,230:0.796917,229:0.789314,228:0.781751,227:0.774227,226:0.766744,225:0.7593,224:0.751895,223:0.74453,222:0.737205,221:0.729919,220:0.722672,219:0.715465,218:0.708298,217:0.70117,216:0.694081,215:0.687031,214:0.68002,213:0.673049,212:0.666117,211:0.659224,210:0.65237,209:0.645555,208:0.638779,207:0.632043,206:0.625345,205:0.618686,204:0.612066,203:0.605484,202:0.598942,201:0.592438,200:0.585973,199:0.579547,198:0.573159,197:0.56681,196:0.560499,195:0.554227,194:0.547994,193:0.541798,192:0.535642,191:0.529523,190:0.523443,189:0.517401,188:0.511398,187:0.505432,186:0.499505,185:0.493616,184:0.487765,183:0.481952,182:0.476177,181:0.47044,180:0.464741,179:0.45908,178:0.453456,177:0.447871,176:0.442323,175:0.436813,174:0.43134,173:0.425905,172:0.420508,171:0.415148,170:0.409826,169:0.404541,168:0.399293,167:0.394083,166:0.38891,165:0.383775,164:0.378676,163:0.373615,162:0.368591,161:0.363604,160:0.358654,159:0.353741,158:0.348865,157:0.344026,156:0.339223,155:0.334458,154:0.329729,153:0.325037,152:0.320382,151:0.315763,150:0.31118,149:0.306635,148:0.302125,147:0.297653,146:0.293216,145:0.288816,144:0.284452,143:0.280124,142:0.275833,141:0.271577,140:0.267358,139:0.263175,138:0.259027,137:0.254916,136:0.25084,135:0.2468,134:0.242796,133:0.238828,132:0.234895,131:0.230998,130:0.227137,129:0.22331,128:0.21952,127:0.215764,126:0.212044,125:0.20836,124:0.20471,123:0.201096,122:0.197516,121:0.193972,120:0.190463,119:0.186989,118:0.183549,117:0.180144,116:0.176774,115:0.173439,114:0.170138,113:0.166872,112:0.163641,111:0.160444,110:0.157281,109:0.154152,108:0.151058,107:0.147998,106:0.144972,105:0.14198,104:0.139022,103:0.136099,102:0.133209,101:0.130352,100:0.12753,99:0.124741,98:0.121986,97:0.119264,96:0.116576,95:0.113921,94:0.111299,93:0.108711,92:0.106156,91:0.103634,90:0.101145,89:0.098689,88:0.096266,87:0.093876,86:0.091518,85:0.089194,84:0.086901,83:0.084642,82:0.082414,81:0.080219,80:0.078057,79:0.075926,78:0.073828,77:0.071761,76:0.069727,75:0.067725,74:0.065754,73:0.063815,72:0.061907,71:0.060032,70:0.058187,69:0.056374,68:0.054592,67:0.052842,66:0.051122,65:0.049433,64:0.047776,63:0.046149,62:0.044553,61:0.042987,60:0.041452,59:0.039947,58:0.038473,57:0.037029,56:0.035614,55:0.03423,54:0.032876,53:0.031551,52:0.030257,51:0.028991,50:0.027755,49:0.026549,48:0.025371,47:0.024223,46:0.023104,45:0.022013,44:0.020951,43:0.019918,42:0.018913,41:0.017936,40:0.016988,39:0.016068,38:0.015175,37:0.014311,36:0.013473,35:0.012664,34:0.011881,33:0.011126,32:0.010398,31:0.009696,30:0.009021,29:0.008373,28:0.007751,27:0.007155,26:0.006585,25:0.006041,24:0.005522,23:0.005028,22:0.00456,21:0.004116,20:0.003697,19:0.003303,18:0.002932,17:0.002586,16:0.002263,15:0.001963,14:0.001687,13:0.001433,12:0.001202,11:0.000992,10:0.000805,9:0.000638,8:0.000493,7:0.000367,6:0.000262,5:0.000175,4:0.000107,3:0.000057,2:0.000023,1:0.000005,0:0);

// Map of inverse gamma values without using exponents
$inv-gamma-map: (1:255,0.999:255,0.998:254,0.997:254,0.996:254,0.995:254,0.994:253,0.993:253,0.992:253,0.991:253,0.99:252,0.989:252,0.988:252,0.987:252,0.986:251,0.985:251,0.984:251,0.983:251,0.982:250,0.981:250,0.98:250,0.979:250,0.978:249,0.977:249,0.976:249,0.975:249,0.974:248,0.973:248,0.972:248,0.971:248,0.97:247,0.969:247,0.968:247,0.967:247,0.966:246,0.965:246,0.964:246,0.963:246,0.962:245,0.961:245,0.96:245,0.959:245,0.958:244,0.957:244,0.956:244,0.955:244,0.954:243,0.953:243,0.952:243,0.951:243,0.95:242,0.949:242,0.948:242,0.947:241,0.946:241,0.945:241,0.944:241,0.943:240,0.942:240,0.941:240,0.94:240,0.939:239,0.938:239,0.937:239,0.936:239,0.935:238,0.934:238,0.933:238,0.932:238,0.931:237,0.93:237,0.929:237,0.928:237,0.927:236,0.926:236,0.925:236,0.924:236,0.923:235,0.922:235,0.921:235,0.92:235,0.919:234,0.918:234,0.917:234,0.916:234,0.915:233,0.914:233,0.913:233,0.912:233,0.911:232,0.91:232,0.909:232,0.908:232,0.907:231,0.906:231,0.905:231,0.904:231,0.903:230,0.902:230,0.901:230,0.9:230,0.899:229,0.898:229,0.897:229,0.896:228,0.895:228,0.894:228,0.893:228,0.892:227,0.891:227,0.89:227,0.889:227,0.888:226,0.887:226,0.886:226,0.885:226,0.884:225,0.883:225,0.882:225,0.881:225,0.88:224,0.879:224,0.878:224,0.877:224,0.876:223,0.875:223,0.874:223,0.873:223,0.872:222,0.871:222,0.87:222,0.869:222,0.868:221,0.867:221,0.866:221,0.865:221,0.864:220,0.863:220,0.862:220,0.861:220,0.86:219,0.859:219,0.858:219,0.857:219,0.856:218,0.855:218,0.854:218,0.853:218,0.852:217,0.851:217,0.85:217,0.849:216,0.848:216,0.847:216,0.846:216,0.845:215,0.844:215,0.843:215,0.842:215,0.841:214,0.84:214,0.839:214,0.838:214,0.837:213,0.836:213,0.835:213,0.834:213,0.833:212,0.832:212,0.831:212,0.83:212,0.829:211,0.828:211,0.827:211,0.826:211,0.825:210,0.824:210,0.823:210,0.822:210,0.821:209,0.82:209,0.819:209,0.818:209,0.817:208,0.816:208,0.815:208,0.814:208,0.813:207,0.812:207,0.811:207,0.81:207,0.809:206,0.808:206,0.807:206,0.806:206,0.805:205,0.804:205,0.803:205,0.802:205,0.801:204,0.8:204,0.799:204,0.798:203,0.797:203,0.796:203,0.795:203,0.794:202,0.793:202,0.792:202,0.791:202,0.79:201,0.789:201,0.788:201,0.787:201,0.786:200,0.785:200,0.784:200,0.783:200,0.782:199,0.781:199,0.78:199,0.779:199,0.778:198,0.777:198,0.776:198,0.775:198,0.774:197,0.773:197,0.772:197,0.771:197,0.77:196,0.769:196,0.768:196,0.767:196,0.766:195,0.765:195,0.764:195,0.763:195,0.762:194,0.761:194,0.76:194,0.759:194,0.758:193,0.757:193,0.756:193,0.755:193,0.754:192,0.753:192,0.752:192,0.751:192,0.75:191,0.749:191,0.748:191,0.747:190,0.746:190,0.745:190,0.744:190,0.743:189,0.742:189,0.741:189,0.74:189,0.739:188,0.738:188,0.737:188,0.736:188,0.735:187,0.734:187,0.733:187,0.732:187,0.731:186,0.73:186,0.729:186,0.728:186,0.727:185,0.726:185,0.725:185,0.724:185,0.723:184,0.722:184,0.721:184,0.72:184,0.719:183,0.718:183,0.717:183,0.716:183,0.715:182,0.714:182,0.713:182,0.712:182,0.711:181,0.71:181,0.709:181,0.708:181,0.707:180,0.706:180,0.705:180,0.704:180,0.703:179,0.702:179,0.701:179,0.7:179,0.699:178,0.698:178,0.697:178,0.696:177,0.695:177,0.694:177,0.693:177,0.692:176,0.691:176,0.69:176,0.689:176,0.688:175,0.687:175,0.686:175,0.685:175,0.684:174,0.683:174,0.682:174,0.681:174,0.68:173,0.679:173,0.678:173,0.677:173,0.676:172,0.675:172,0.674:172,0.673:172,0.672:171,0.671:171,0.67:171,0.669:171,0.668:170,0.667:170,0.666:170,0.665:170,0.664:169,0.663:169,0.662:169,0.661:169,0.66:168,0.659:168,0.658:168,0.657:168,0.656:167,0.655:167,0.654:167,0.653:167,0.652:166,0.651:166,0.65:166,0.649:165,0.648:165,0.647:165,0.646:165,0.645:164,0.644:164,0.643:164,0.642:164,0.641:163,0.64:163,0.639:163,0.638:163,0.637:162,0.636:162,0.635:162,0.634:162,0.633:161,0.632:161,0.631:161,0.63:161,0.629:160,0.628:160,0.627:160,0.626:160,0.625:159,0.624:159,0.623:159,0.622:159,0.621:158,0.62:158,0.619:158,0.618:158,0.617:157,0.616:157,0.615:157,0.614:157,0.613:156,0.612:156,0.611:156,0.61:156,0.609:155,0.608:155,0.607:155,0.606:155,0.605:154,0.604:154,0.603:154,0.602:154,0.601:153,0.6:153,0.599:153,0.598:152,0.597:152,0.596:152,0.595:152,0.594:151,0.593:151,0.592:151,0.591:151,0.59:150,0.589:150,0.588:150,0.587:150,0.586:149,0.585:149,0.584:149,0.583:149,0.582:148,0.581:148,0.58:148,0.579:148,0.578:147,0.577:147,0.576:147,0.575:147,0.574:146,0.573:146,0.572:146,0.571:146,0.57:145,0.569:145,0.568:145,0.567:145,0.566:144,0.565:144,0.564:144,0.563:144,0.562:143,0.561:143,0.56:143,0.559:143,0.558:142,0.557:142,0.556:142,0.555:142,0.554:141,0.553:141,0.552:141,0.551:141,0.55:140,0.549:140,0.548:140,0.547:139,0.546:139,0.545:139,0.544:139,0.543:138,0.542:138,0.541:138,0.54:138,0.539:137,0.538:137,0.537:137,0.536:137,0.535:136,0.534:136,0.533:136,0.532:136,0.531:135,0.53:135,0.529:135,0.528:135,0.527:134,0.526:134,0.525:134,0.524:134,0.523:133,0.522:133,0.521:133,0.52:133,0.519:132,0.518:132,0.517:132,0.516:132,0.515:131,0.514:131,0.513:131,0.512:131,0.511:130,0.51:130,0.509:130,0.508:130,0.507:129,0.506:129,0.505:129,0.504:129,0.503:128,0.502:128,0.501:128,0.5:128,0.499:127,0.498:127,0.497:127,0.496:126,0.495:126,0.494:126,0.493:126,0.492:125,0.491:125,0.49:125,0.489:125,0.488:124,0.487:124,0.486:124,0.485:124,0.484:123,0.483:123,0.482:123,0.481:123,0.48:122,0.479:122,0.478:122,0.477:122,0.476:121,0.475:121,0.474:121,0.473:121,0.472:120,0.471:120,0.47:120,0.469:120,0.468:119,0.467:119,0.466:119,0.465:119,0.464:118,0.463:118,0.462:118,0.461:118,0.46:117,0.459:117,0.458:117,0.457:117,0.456:116,0.455:116,0.454:116,0.453:116,0.452:115,0.451:115,0.45:115,0.449:114,0.448:114,0.447:114,0.446:114,0.445:113,0.444:113,0.443:113,0.442:113,0.441:112,0.44:112,0.439:112,0.438:112,0.437:111,0.436:111,0.435:111,0.434:111,0.433:110,0.432:110,0.431:110,0.43:110,0.429:109,0.428:109,0.427:109,0.426:109,0.425:108,0.424:108,0.423:108,0.422:108,0.421:107,0.42:107,0.419:107,0.418:107,0.417:106,0.416:106,0.415:106,0.414:106,0.413:105,0.412:105,0.411:105,0.41:105,0.409:104,0.408:104,0.407:104,0.406:104,0.405:103,0.404:103,0.403:103,0.402:103,0.401:102,0.4:102,0.399:102,0.398:101,0.397:101,0.396:101,0.395:101,0.394:100,0.393:100,0.392:100,0.391:100,0.39:99,0.389:99,0.388:99,0.387:99,0.386:98,0.385:98,0.384:98,0.383:98,0.382:97,0.381:97,0.38:97,0.379:97,0.378:96,0.377:96,0.376:96,0.375:96,0.374:95,0.373:95,0.372:95,0.371:95,0.37:94,0.369:94,0.368:94,0.367:94,0.366:93,0.365:93,0.364:93,0.363:93,0.362:92,0.361:92,0.36:92,0.359:92,0.358:91,0.357:91,0.356:91,0.355:91,0.354:90,0.353:90,0.352:90,0.351:90,0.35:89,0.349:89,0.348:89,0.347:88,0.346:88,0.345:88,0.344:88,0.343:87,0.342:87,0.341:87,0.34:87,0.339:86,0.338:86,0.337:86,0.336:86,0.335:85,0.334:85,0.333:85,0.332:85,0.331:84,0.33:84,0.329:84,0.328:84,0.327:83,0.326:83,0.325:83,0.324:83,0.323:82,0.322:82,0.321:82,0.32:82,0.319:81,0.318:81,0.317:81,0.316:81,0.315:80,0.314:80,0.313:80,0.312:80,0.311:79,0.31:79,0.309:79,0.308:79,0.307:78,0.306:78,0.305:78,0.304:78,0.303:77,0.302:77,0.301:77,0.3:77,0.299:76,0.298:76,0.297:76,0.296:75,0.295:75,0.294:75,0.293:75,0.292:74,0.291:74,0.29:74,0.289:74,0.288:73,0.287:73,0.286:73,0.285:73,0.284:72,0.283:72,0.282:72,0.281:72,0.28:71,0.279:71,0.278:71,0.277:71,0.276:70,0.275:70,0.274:70,0.273:70,0.272:69,0.271:69,0.27:69,0.269:69,0.268:68,0.267:68,0.266:68,0.265:68,0.264:67,0.263:67,0.262:67,0.261:67,0.26:66,0.259:66,0.258:66,0.257:66,0.256:65,0.255:65,0.254:65,0.253:65,0.252:64,0.251:64,0.25:64,0.249:63,0.248:63,0.247:63,0.246:63,0.245:62,0.244:62,0.243:62,0.242:62,0.241:61,0.24:61,0.239:61,0.238:61,0.237:60,0.236:60,0.235:60,0.234:60,0.233:59,0.232:59,0.231:59,0.23:59,0.229:58,0.228:58,0.227:58,0.226:58,0.225:57,0.224:57,0.223:57,0.222:57,0.221:56,0.22:56,0.219:56,0.218:56,0.217:55,0.216:55,0.215:55,0.214:55,0.213:54,0.212:54,0.211:54,0.21:54,0.209:53,0.208:53,0.207:53,0.206:53,0.205:52,0.204:52,0.203:52,0.202:52,0.201:51,0.2:51,0.199:51,0.198:50,0.197:50,0.196:50,0.195:50,0.194:49,0.193:49,0.192:49,0.191:49,0.19:48,0.189:48,0.188:48,0.187:48,0.186:47,0.185:47,0.184:47,0.183:47,0.182:46,0.181:46,0.18:46,0.179:46,0.178:45,0.177:45,0.176:45,0.175:45,0.174:44,0.173:44,0.172:44,0.171:44,0.17:43,0.169:43,0.168:43,0.167:43,0.166:42,0.165:42,0.164:42,0.163:42,0.162:41,0.161:41,0.16:41,0.159:41,0.158:40,0.157:40,0.156:40,0.155:40,0.154:39,0.153:39,0.152:39,0.151:39,0.15:38,0.149:38,0.148:38,0.147:37,0.146:37,0.145:37,0.144:37,0.143:36,0.142:36,0.141:36,0.14:36,0.139:35,0.138:35,0.137:35,0.136:35,0.135:34,0.134:34,0.133:34,0.132:34,0.131:33,0.13:33,0.129:33,0.128:33,0.127:32,0.126:32,0.125:32,0.124:32,0.123:31,0.122:31,0.121:31,0.12:31,0.119:30,0.118:30,0.117:30,0.116:30,0.115:29,0.114:29,0.113:29,0.112:29,0.111:28,0.11:28,0.109:28,0.108:28,0.107:27,0.106:27,0.105:27,0.104:27,0.103:26,0.102:26,0.101:26,0.1:26,0.099:25,0.098:25,0.097:25,0.096:24,0.095:24,0.094:24,0.093:24,0.092:23,0.091:23,0.09:23,0.089:23,0.088:22,0.087:22,0.086:22,0.085:22,0.084:21,0.083:21,0.082:21,0.081:21,0.08:20,0.079:20,0.078:20,0.077:20,0.076:19,0.075:19,0.074:19,0.073:19,0.072:18,0.071:18,0.07:18,0.069:18,0.068:17,0.067:17,0.066:17,0.065:17,0.064:16,0.063:16,0.062:16,0.061:16,0.06:15,0.059:15,0.058:15,0.057:15,0.056:14,0.055:14,0.054:14,0.053:14,0.052:13,0.051:13,0.05:13,0.049:12,0.048:12,0.047:12,0.046:12,0.045:11,0.044:11,0.043:11,0.042:11,0.041:10,0.04:10,0.039:10,0.038:10,0.037:9,0.036:9,0.035:9,0.034:9,0.033:8,0.032:8,0.031:8,0.03:8,0.029:7,0.028:7,0.027:7,0.026:7,0.025:6,0.024:6,0.023:6,0.022:6,0.021:5,0.02:5,0.019:5,0.018:5,0.017:4,0.016:4,0.015:4,0.014:4,0.013:3,0.012:3,0.011:3,0.01:3,0.009:2,0.008:2,0.007:2,0.006:2,0.005:1,0.004:1,0.003:1,0.002:1,0.001:0,0:0);

// Returns raw luminescence calculation of a single color
@function color-lumin($color-a) {
  $r: red($color-a);
  $g: green($color-a);
  $b: blue($color-a);
  $rr: round($r);
  $gr: round($g);
  $br: round($b);
  $rm: map-get($lum-map, $rr);
  $gm: map-get($lum-map, $gr);
  $bm: map-get($lum-map, $br);
  $lum: ($rm * 0.299) + ($gm * 0.587) + ($bm * 0.114) + 0.05;
  @return $lum;
}

// Returns raw reflection calculation of a single color
@function color-reflc($color-a) {
  $r: red($color-a);
  $g: green($color-a);
  $b: blue($color-a);
  $rr: round($r);
  $gr: round($g);
  $br: round($b);
  $rm: map-get($ref-map, $rr);
  $gm: map-get($ref-map, $gr);
  $bm: map-get($ref-map, $br);
  $lum: ($rm * 0.3333) + ($gm * 0.3333) + ($bm * 0.3333) + 0.05;
  @return $lum;
}

// Returns completed color compare with updated forumlas
@function compare-color($color-b, $color-c) {
  $lum1: color-lumin($color-b);
  $lum2: color-lumin($color-c);
  $ref1: color-reflc($color-b);
  $ref2: color-reflc($color-c);
  $lumtot: 0;
  $reftot: 0;
  @if ($lum1 > $lum2) {
      $lumtot: $lum1 / $lum2;
  } @else {
      $lumtot: $lum2 / $lum1;
  }
  @if ($ref1 > $ref2) {
      $reftot: $ref1 / $ref2;
  } @else {
      $reftot: $ref2 / $ref1;
  }
  @return $lumtot * $reftot;
}

// Returns use of white or black text based upon green value
@function text-color-compare($color-b) {
  $g: green($color-b);
  @if ($g > 128) {
      @return #080808;
  } @else {
      @return #f7f7f7;
  }
}

// Brings outlying colors into contrast requirements against white
@function color-fix($color-d) {
  $compare: compare-color($color-d, #ffffff);
  $count: 100;
  @if ($compare < 10) {
    @while ($compare < 10) {
      $count: $count - 0.1;
      $color-d: mix($color-d, #000000, $count);
      $compare: compare-color($color-d, #ffffff);
      @if ($color-d == #000000) {
        $compare: 10;
      }
    }
    @return $color-d;
  } @else {
    @return $color-d;
  }
}

// Returns gamma map number
@function gamma($num) {
    $num: round($num);
    $gam: map-get($gamma-map, $num);
    @return $gam;
}

// Returns inverse gamma map number
@function inv-gamma($num) {
    $num: $num * 1000;
    $num: round($num);
	$num: $num / 1000;
    $gam: map-get($inv-gamma-map, $num);
    @return $gam;
}

// Converts RGB to X of XYZ value
@function rgb-to-x($color-a) {
    $r: gamma(red($color-a));
    $g: gamma(green($color-a));
    $b: gamma(blue($color-a));
    $x: (0.430574 * $r) + (0.341550 * $g) + (0.178325 * $b);
    @return $x;
}

// Converts RGB to Y of XYZ value
@function rgb-to-y($color-a) {
    $r: gamma(red($color-a));
    $g: gamma(green($color-a));
    $b: gamma(blue($color-a));
    $y: (0.222015 * $r) + (0.706655 * $g) + (0.071330 * $b);;
    @return $y;
}

// Converts RGB to Z of XYZ value
@function rgb-to-z($color-a) {
    $r: gamma(red($color-a));
    $g: gamma(green($color-a));
    $b: gamma(blue($color-a));
    $z: (0.020183 * $r) + (0.129553 * $g) + (0.939180 * $b);
    @return $z;
}

// Converts XYZ to R of RGB value
@function xyz-to-r($x, $y, $z) {
    $r: (3.063218 * $x) - (1.393325 * $y) - (0.475802 * $z);
    @return $r;
}

// Converts XYZ to G of RGB value
@function xyz-to-g($x, $y, $z) {
    $g: (-0.969243 * $x) + (1.875966 * $y) + (0.041555 * $z);
    @return $g;
}

// Converts XYZ to B of RGB value
@function xyz-to-b($x, $y, $z) {
    $b: (0.067871 * $x) - (0.228834 * $y) + (1.069251 * $z);
    @return $b;
}

// Returns correct adjustment of color based upon inputs
@function calculations($color-a, $cpu, $cpv, $am, $ayi) {
    $wx: 0.312713;
    $wy: 0.329016;
    $wz: 0.358271;

    $x: rgb-to-x($color-a);
    $y: rgb-to-y($color-a);
    $z: rgb-to-z($color-a);

    $sum: $x + $y + $z;
    $cu: 0;
    $cv: 0;

    @if ($sum != 0) {
        $cu: $x / $sum;
        $cv: $y / $sum;
    }

    $nx: ($wx * $y) / $wy;
    $nz: ($wz * $y) / $wy;
    $clm: 0;
	$sx: 0;
	$sy: 0;
	$sz: 0;

    @if ($cu < $cpu) {
        $clm: ($cpv - $cv) / ($cpu - $cu);
    } @else {
        $clm: ($cv - $cpv) / ($cu - $cpu);
    }

    $clyi: $cv - $cu * $clm;
    $du: ($ayi - $clyi) / ($clm - $am);
    $dv: ($clm * $du) + $clyi;

    $sx: ($du * $y) / $dv;
    $sy: $y;
    $sz: ((1 - ($du + $dv)) * $y) / $dv;
    $sr: xyz-to-r($sx, $sy, $sz);
    $sg: xyz-to-g($sx, $sy, $sz);
    $sb: xyz-to-b($sx, $sy, $sz);

    $dx: $nx - $sx;
    $dy: 0;
    $dz: $nz - $sz;
    $dr: xyz-to-r($dx, $dy, $dz);
    $dg: xyz-to-g($dx, $dy, $dz);
    $db: xyz-to-b($dx, $dy, $dz);

    $adjr: 0;
    $adjg: 0;
    $adjb: 0;

    @if ($dr == 0) {
      $adjr: 0;
    } @else if ($sr < 0) {
      $adjr: (0 - $sr) / $dr;
    } @else {
      $adjr: (1 - $sr) / $dr;
    }

    @if ($dg == 0) {
      $adjg: 0;
    } @else {
      @if ($sg < 0) {
        $adjg: (0 - $sg) / $dg;
      } @else {
        $adjg: (1 - $sg) / $dg;
      }
    }

    @if ($db == 0) {
      $adjb: 0;
    } @else {
      @if ($sb < 0) {
        $adjb: (0 - $sb) / $db;
      } @else {
        $adjb: (1 - $sb) / $db;
      }
    }

    @if ($adjr > 1 or $adjr < 0) {
      $adjr: 0;
    }

    @if ($adjg > 1 or $adjg < 0) {
      $adjg: 0;
    }

    @if ($adjb > 1 or $adjb < 0) {
      $adjb: 0;
    }

    $adjust: max($adjr, $adjg, $adjb);

    $sr: $sr + ($adjust * $dr);
    $sg: $sg + ($adjust * $dg);
    $sb: $sb + ($adjust * $db);

    @if ($sr <= 0) {
        $sr: 0;
    } @else if ($sr >= 1) {
      $sr: 255;
    } @else {
      $sr: inv-gamma($sr);
    }

    @if ($sg <= 0) {
        $sg: 0;
    } @else if ($sg >= 1) {
      $sg: 255;
    } @else {
      $sg: inv-gamma($sg);
    }

    @if ($sb <= 0) {
        $sb: 0;
    } @else if ($sb >= 1) {
      $sb: 255;
    } @else {
      $sb: inv-gamma($sb);
    }

    @return rgb($sr, $sg, $sb);
}

// Returns adjusted anomaly value
@function anomylize($color-a, $color-b) {
    $r-a: red($color-a);
    $g-a: green($color-a);
    $b-a: blue($color-a);
    $r-b: red($color-b);
    $g-b: green($color-b);
    $b-b: blue($color-b);
    @return rgb(((1.75 * $r-b) + ($r-a))/2.75,((1.75 * $g-b) + ($g-a))/2.75,((1.75 * $b-b) + ($b-a))/2.75);
}

// Passes color and prot values to calculations function
@function protanopia($color-a) {
    $cpu: 0.735;
    $cpv: 0.265;
    $am: 1.273463;
    $ayi: -0.073894;
    @return calculations($color-a, $cpu, $cpv, $am, $ayi);
}

// Passes color and prot values to calculations & anomylize functions
@function protanomaly($color-a) {
    $color-b: protanopia($color-a);
    @return anomylize($color-a, $color-b);
}

// Passes color and deuter values to calculations function
@function deuteranopia($color-a) {
    $cpu: 1.14;
    $cpv: -0.14;
    $am: 0.968437;
    $ayi: 0.003331;
    @return calculations($color-a, $cpu, $cpv, $am, $ayi);
}

// Passes color and duter values to calculations & anomylize functions
@function deuteranomaly($color-a) {
    $color-b: deuteranopia($color-a);
    @return anomylize($color-a, $color-b);
}

// Passes color and trit values to calculations function
@function tritanopia($color-a) {
    $cpu: 0.171;
    $cpv: -0.003;
    $am: 0.062921;
    $ayi: 0.292119;
    @return calculations($color-a, $cpu, $cpv, $am, $ayi);
}

// Passes color and trit values to calculations & anomylize functions
@function tritanomaly($color-a) {
    $color-b: tritanopia($color-a);
    @return anomylize($color-a, $color-b);
}

// Returns achroma values
@function achromatopsia($color-a) {
    $r: red($color-a);
    $g: green($color-a);
    $b: blue($color-a);
    $z: ($r * 0.299) + ($g * 0.587) + ($b * 0.114);
    @return rgb($z,$z,$z);
}

// Passes color to achromatopsia & anomylize functions
@function achromatomaly($color-a) {
    $color-b: achromatopsia($color-a);
    @return anomylize($color-a, $color-b);
}

$penta-0-pre-1: color-fix($primary-color);

$penta-72-pre-1: ryb-adjust-hue($penta-0-pre-1, 72);
$penta-72-pre-1: color-fix($penta-72-pre-1);

$penta-144-pre-1: ryb-adjust-hue($penta-72-pre-1, 72);
$penta-144-pre-1: color-fix($penta-144-pre-1);
$penta-144-pre-2: ryb-adjust-hue($penta-0-pre-1, 144);
$penta-144-pre-2: color-fix($penta-144-pre-2);

$penta-216-pre-1: ryb-adjust-hue($penta-144-pre-1, 72);
$penta-216-pre-1: color-fix($penta-216-pre-1);
$penta-216-pre-2: ryb-adjust-hue($penta-0-pre-1, 216);
$penta-216-pre-2: color-fix($penta-216-pre-2);

$penta-288-pre-1: ryb-adjust-hue($penta-216-pre-1, 72);
$penta-288-pre-1: color-fix($penta-288-pre-1);
$penta-288-pre-2: ryb-adjust-hue($penta-0-pre-1, 288);
$penta-288-pre-2: color-fix($penta-216-pre-2);

$penta-0-pre-2: ryb-adjust-hue($penta-288-pre-1, 72);
$penta-0-pre-2: color-fix($penta-0-pre-2);

$penta-72-pre-2: ryb-adjust-hue($penta-0-pre-2, 72);
$penta-72-pre-2: color-fix($penta-72-pre-2);

$penta-0-mix: mix($penta-0-pre-1, $penta-0-pre-2, 50%);
$penta-72-mix: mix($penta-72-pre-1, $penta-72-pre-2, 50%);
$penta-144-mix: mix($penta-144-pre-1, $penta-144-pre-2, 50%);
$penta-216-mix: mix($penta-216-pre-1, $penta-216-pre-2, 50%);
$penta-288-mix: mix($penta-288-pre-1, $penta-288-pre-2, 50%);

$penta-0: color-fix($penta-0-mix);
$penta-72: color-fix($penta-72-mix);
$penta-144: color-fix($penta-144-mix);
$penta-216: color-fix($penta-216-mix);
$penta-288: color-fix($penta-288-mix);
$greyscale-0: #ebebeb;
$greyscale-1: #9a9a9a;
$greyscale-2: #7d7d7d;
$greyscale-3: #606060;
$greyscale-4: #434343;
$greyscale-5: #262626;

$penta-0-35: lighten($penta-0, 15%);
$penta-72-35: lighten($penta-72, 15%);
$penta-144-35: lighten($penta-144, 15%);
$penta-216-35: lighten($penta-216, 15%);
$penta-288-35: lighten($penta-288, 15%);
$greyscale-1-35: lighten($greyscale-1, 15%);
$greyscale-2-35: lighten($greyscale-2, 15%);
$greyscale-3-35: lighten($greyscale-3, 15%);
$greyscale-4-35: lighten($greyscale-4, 15%);
$greyscale-5-35: lighten($greyscale-5, 15%);

$penta-0-65: darken($penta-0, 15%);
$penta-72-65: darken($penta-72, 15%);
$penta-144-65: darken($penta-144, 15%);
$penta-216-65: darken($penta-216, 15%);
$penta-288-65: darken($penta-288, 15%);
$greyscale-1-65: darken($greyscale-1, 15%);
$greyscale-2-65: darken($greyscale-2, 15%);
$greyscale-3-65: darken($greyscale-3, 15%);
$greyscale-4-65: darken($greyscale-4, 15%);
$greyscale-5-65: darken($greyscale-5, 15%);

$penta-0-protanopia: protanopia($penta-0);
$penta-0-protanomaly: protanomaly($penta-0);
$penta-0-deuteranopia: deuteranopia($penta-0);
$penta-0-deuteranomaly: deuteranomaly($penta-0);
$penta-0-tritanopia: tritanopia($penta-0);
$penta-0-tritanomaly: tritanomaly($penta-0);
$penta-0-achromatopsia: achromatopsia($penta-0);
$penta-0-achromatomaly: achromatomaly($penta-0);

$penta-72-protanopia: protanopia($penta-72);
$penta-72-protanomaly: protanomaly($penta-72);
$penta-72-deuteranopia: deuteranopia($penta-72);
$penta-72-deuteranomaly: deuteranomaly($penta-72);
$penta-72-tritanopia: tritanopia($penta-72);
$penta-72-tritanomaly: tritanomaly($penta-72);
$penta-72-achromatopsia: achromatopsia($penta-72);
$penta-72-achromatomaly: achromatomaly($penta-72);

$penta-144-protanopia: protanopia($penta-144);
$penta-144-protanomaly: protanomaly($penta-144);
$penta-144-deuteranopia: deuteranopia($penta-144);
$penta-144-deuteranomaly: deuteranomaly($penta-144);
$penta-144-tritanopia: tritanopia($penta-144);
$penta-144-tritanomaly: tritanomaly($penta-144);
$penta-144-achromatopsia: achromatopsia($penta-144);
$penta-144-achromatomaly: achromatomaly($penta-144);

$penta-216-protanopia: protanopia($penta-216);
$penta-216-protanomaly: protanomaly($penta-216);
$penta-216-deuteranopia: deuteranopia($penta-216);
$penta-216-deuteranomaly: deuteranomaly($penta-216);
$penta-216-tritanopia: tritanopia($penta-216);
$penta-216-tritanomaly: tritanomaly($penta-216);
$penta-216-achromatopsia: achromatopsia($penta-216);
$penta-216-achromatomaly: achromatomaly($penta-216);

$penta-288-protanopia: protanopia($penta-288);
$penta-288-protanomaly: protanomaly($penta-288);
$penta-288-deuteranopia: deuteranopia($penta-288);
$penta-288-deuteranomaly: deuteranomaly($penta-288);
$penta-288-tritanopia: tritanopia($penta-288);
$penta-288-tritanomaly: tritanomaly($penta-288);
$penta-288-achromatopsia: achromatopsia($penta-288);
$penta-288-achromatomaly: achromatomaly($penta-288);

$greyscale-1-protanopia: protanopia($greyscale-1);
$greyscale-1-protanomaly: protanomaly($greyscale-1);
$greyscale-1-deuteranopia: deuteranopia($greyscale-1);
$greyscale-1-deuteranomaly: deuteranomaly($greyscale-1);
$greyscale-1-tritanopia: tritanopia($greyscale-1);
$greyscale-1-tritanomaly: tritanomaly($greyscale-1);
$greyscale-1-achromatopsia: achromatopsia($greyscale-1);
$greyscale-1-achromatomaly: achromatomaly($greyscale-1);

$greyscale-2-protanopia: protanopia($greyscale-2);
$greyscale-2-protanomaly: protanomaly($greyscale-2);
$greyscale-2-deuteranopia: deuteranopia($greyscale-2);
$greyscale-2-deuteranomaly: deuteranomaly($greyscale-2);
$greyscale-2-tritanopia: tritanopia($greyscale-2);
$greyscale-2-tritanomaly: tritanomaly($greyscale-2);
$greyscale-2-achromatopsia: achromatopsia($greyscale-2);
$greyscale-2-achromatomaly: achromatomaly($greyscale-2);

$greyscale-3-protanopia: protanopia($greyscale-3);
$greyscale-3-protanomaly: protanomaly($greyscale-3);
$greyscale-3-deuteranopia: deuteranopia($greyscale-3);
$greyscale-3-deuteranomaly: deuteranomaly($greyscale-3);
$greyscale-3-tritanopia: tritanopia($greyscale-3);
$greyscale-3-tritanomaly: tritanomaly($greyscale-3);
$greyscale-3-achromatopsia: achromatopsia($greyscale-3);
$greyscale-3-achromatomaly: achromatomaly($greyscale-3);

$greyscale-4-protanopia: protanopia($greyscale-4);
$greyscale-4-protanomaly: protanomaly($greyscale-4);
$greyscale-4-deuteranopia: deuteranopia($greyscale-4);
$greyscale-4-deuteranomaly: deuteranomaly($greyscale-4);
$greyscale-4-tritanopia: tritanopia($greyscale-4);
$greyscale-4-tritanomaly: tritanomaly($greyscale-4);
$greyscale-4-achromatopsia: achromatopsia($greyscale-4);
$greyscale-4-achromatomaly: achromatomaly($greyscale-4);

$greyscale-5-protanopia: protanopia($greyscale-5);
$greyscale-5-protanomaly: protanomaly($greyscale-5);
$greyscale-5-deuteranopia: deuteranopia($greyscale-5);
$greyscale-5-deuteranomaly: deuteranomaly($greyscale-5);
$greyscale-5-tritanopia: tritanopia($greyscale-5);
$greyscale-5-tritanomaly: tritanomaly($greyscale-5);
$greyscale-5-achromatopsia: achromatopsia($greyscale-5);
$greyscale-5-achromatomaly: achromatomaly($greyscale-5);
